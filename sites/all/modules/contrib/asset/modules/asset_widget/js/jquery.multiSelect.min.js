jQuery&&function(b){function j(b,e,c){for(var d="",g=0;g<e.length;g++)if(e[g].optgroup)d+='<label class="optGroup">',d=c.optGroupSelectable?d+('<input type="checkbox" class="optGroup" />'+e[g].optgroup):d+e[g].optgroup,d+='</label><div class="optGroupContainer">',d+=j(b,e[g].options,c),d+="</div>";else{var f=e[g],h='<label><input type="checkbox" name="'+b+'" value="'+f.value+'"';f.selected&&(h+=' checked="checked"');h+=" /><span>"+f.text+"</span></label>";d+=h}return d}function m(a){var e=b(this),
  c=e.next(".multiSelectOptions"),d=e.data("config"),g=e.data("callback");c.html("");var f="";d.selectAll&&(f+='<label class="selectAll"><input type="checkbox" class="selectAll" />'+d.selectAllText+"</label>");f+=j(e.attr("name"),a,d);c.html(f);a=c.width();f=!1;c.height()>d.listHeight?(c.css("height",d.listHeight+"px"),f=!0):c.css("height","");a=f&&a==c.width()?17:0;c.width()+a<e.outerWidth()?c.css("width",e.outerWidth()-2+"px"):c.css("width",c.width()+a+"px");b.fn.bgiframe&&e.next(".multiSelectOptions").bgiframe({width:c.width(),
  height:c.height()});d.selectAll&&c.find("INPUT.selectAll").click(function(){c.find("INPUT:checkbox").attr("checked",b(this).attr("checked")).parent("LABEL").toggleClass("checked",b(this).attr("checked"))});d.optGroupSelectable&&(c.addClass("optGroupHasCheckboxes"),c.find("INPUT.optGroup").click(function(){b(this).parent().next().find("INPUT:checkbox").attr("checked",b(this).attr("checked")).parent("LABEL").toggleClass("checked",b(this).attr("checked"))}));c.find("INPUT:checkbox").click(function(){$exception=
  0;c.find(".selectAll").hasClass("checked")&!b(this).parent("LABEL").hasClass("selectAll")&&($exception=1);b(this).parent("LABEL").toggleClass("checked",b(this).attr("checked"));k.call(e);e.focus();b(this).parent().parent().hasClass("optGroupContainer")&&n.call(e,b(this).parent().parent().prev());g&&g(b(this));1==$exception&&(c.find("label").removeClass("checked").find("input:checkbox").removeAttr("checked"),b(this).parent("LABEL").hasClass("last")||b(this).attr("checked","checked").parent("LABEL").addClass("checked"),
  k.call(e))});c.each(function(){b(this).find("INPUT:checked").parent().addClass("checked")});k.call(e);d.optGroupSelectable&&c.find("LABEL.optGroup").each(function(){n.call(e,b(this))});c.find("LABEL:has(INPUT)").hover(function(){b(this).parent().find("LABEL").removeClass("hover");b(this).addClass("hover")},function(){b(this).parent().find("LABEL").removeClass("hover")});e.keydown(function(a){var c=b(this).next(".multiSelectOptions");if("hidden"!=c.css("visibility")){if(9==a.keyCode)return b(this).addClass("focus").trigger("click"),
  b(this).focus().next(":input").focus(),!0;(27==a.keyCode||37==a.keyCode||39==a.keyCode)&&b(this).addClass("focus").trigger("click");if(40==a.keyCode||38==a.keyCode){var d=c.find("LABEL"),f=d.index(d.filter(".hover")),l=-1;0>f?c.find("LABEL:first").addClass("hover"):40==a.keyCode&&f<d.length-1?l=f+1:38==a.keyCode&&0<f&&(l=f-1);0<=l&&(b(d.get(f)).removeClass("hover"),b(d.get(l)).addClass("hover"),p(c));return!1}if(13==a.keyCode||32==a.keyCode)return a=c.find("LABEL.hover INPUT:checkbox"),a.attr("checked",
  !a.attr("checked")).parent("LABEL").toggleClass("checked",a.attr("checked")),a.hasClass("selectAll")&&c.find("INPUT:checkbox").attr("checked",a.attr("checked")).parent("LABEL").addClass("checked").toggleClass("checked",a.attr("checked")),k.call(e),g&&g(b(this)),!1;if(33<=a.keyCode&&126>=a.keyCode){var d=c.find("LABEL:startsWith("+String.fromCharCode(a.keyCode)+")"),j=d.index(d.filter("LABEL.hover")),f=d.filter(function(a){return a>j}),d=(1<=f.length?f:d).filter("LABEL:first");1==d.length&&(c.find("LABEL.hover").removeClass("hover"),
  d.addClass("hover"),p(c))}}else{if(38==a.keyCode||40==a.keyCode||13==a.keyCode||32==a.keyCode)return b(this).removeClass("focus").trigger("click"),c.find("LABEL:first").addClass("hover"),!1;if(9==a.keyCode)return c.next(":input").focus(),!0}if(13==a.keyCode)return!1})}function p(a){var b=a.find("LABEL.hover").position().top+a.find("LABEL.hover").outerHeight();b>a.innerHeight()&&a.scrollTop(a.scrollTop()+b-a.innerHeight());0>a.find("LABEL.hover").position().top&&a.scrollTop(a.scrollTop()+a.find("LABEL.hover").position().top)}
  function n(a){if(b(this).data("config").optGroupSelectable){var e=!0;b(a).next().find("INPUT:checkbox").each(function(){if(!b(this).attr("checked"))return e=!1});b(a).find("INPUT.optGroup").attr("checked",e).parent("LABEL").toggleClass("checked",e)}}function k(){var a=b(this),e=a.next(".multiSelectOptions"),c=a.data("config"),d=0,g=!0,f="";e.find("INPUT:checkbox").not(".selectAll, .optGroup").each(function(){b(this).attr("checked")?(d++,f=f+b(this).parent().text()+", "):g=!1});f=f.replace(/\s*\,\s*$/,
    "");0==d?a.find("span").html(c.noneSelected):"*"==c.oneOrMoreSelected?(a.find("span").html(f),a.attr("title",f)):a.find("span").html(c.oneOrMoreSelected.replace("%",d));c.selectAll&&e.find("INPUT.selectAll").attr("checked",g).parent("LABEL").toggleClass("checked",g)}b.extend(b.fn,{multiSelect:function(a,e){a||(a={});void 0==a.selectAll&&(a.selectAll=!0);void 0==a.selectAllText&&(a.selectAllText="Select All");void 0==a.noneSelected&&(a.noneSelected="Select options");void 0==a.oneOrMoreSelected&&(a.oneOrMoreSelected=
    "% selected");void 0==a.optGroupSelectable&&(a.optGroupSelectable=!1);void 0==a.listHeight&&(a.listHeight=150);b(this).each(function(){var c=b(this);b(c).after('<a href="javascript:;" class="multiSelect"><span></span></a><div class="multiSelectOptions" style="position: absolute; z-index: 99999; visibility: hidden;"></div>');var d=b(c).next(".multiSelect");d.next(".multiSelectOptions");d.find("span").css("width",b(c).width()+"px");d.data("config",a);d.data("callback",e);var g=[];b(c).children().each(function(){if("OPTGROUP"==
    this.tagName.toUpperCase()){var a=[];g.push({optgroup:b(this).attr("label"),options:a});b(this).children("OPTION").each(function(){""!=b(this).val()&&a.push({text:b(this).html(),value:b(this).val(),selected:b(this).attr("selected")})})}else"OPTION"==this.tagName.toUpperCase()&&""!=b(this).val()&&g.push({text:b(this).html(),value:b(this).val(),selected:b(this).attr("selected")})});b(c).remove();d.attr("id",b(c).attr("id"));d.attr("name",b(c).attr("name"));m.call(d,g);d.hover(function(){b(this).addClass("hover")},
    function(){b(this).removeClass("hover")}).click(function(){b(this).hasClass("active")?b(this).multiSelectOptionsHide():b(this).multiSelectOptionsShow();return!1}).focus(function(){b(this).addClass("focus")}).blur(function(){b(this).removeClass("focus")});b(document).click(function(a){b(a.target).parents().andSelf().is(".multiSelectOptions")||d.multiSelectOptionsHide()})})},multiSelectOptionsUpdate:function(a){m.call(b(this),a)},multiSelectOptionsHide:function(){b(this).removeClass("active").removeClass("hover").next(".multiSelectOptions").css("visibility",
    "hidden")},multiSelectOptionsShow:function(){var a=b(this),e=a.next(".multiSelectOptions");a.data("config");b(".multiSelect").multiSelectOptionsHide();e.find("LABEL").removeClass("hover");a.addClass("active").next(".multiSelectOptions").css("visibility","visible");a.focus();a.next(".multiSelectOptions").scrollTop(0);e=a.position();a.next(".multiSelectOptions").css({top:e.top+b(this).outerHeight()+"px"});a.next(".multiSelectOptions").css({left:e.left+"px"})},selectedValuesString:function(){var a="";
    b(this).next(".multiSelectOptions").find("INPUT:checkbox:checked").not(".optGroup, .selectAll").each(function(){a+=b(this).attr("value")+","});return a.replace(/\s*\,\s*$/,"")}});b.expr[":"].startsWith=function(a,e,c){e=c[3];return!e?!1:eval("/^[/s]*"+e+"/i").test(b(a).text())}}(jQuery);